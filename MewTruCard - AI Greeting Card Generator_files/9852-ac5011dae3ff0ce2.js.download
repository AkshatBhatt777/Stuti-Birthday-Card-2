"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9852],{89852:function(e,r,t){t.d(r,{SubscriptionButton:function(){return b}});var s=t(67949),a=t(86265),n=t(76126),i=t(71523),c=t(17616),l=t(69151),o=t(28265),d=t(14796),u=t(93505),x=t(25512),p=t(41425),m=t(83892),h=t(19290);let g=a.forwardRef((e,r)=>{let{className:t,orientation:a="horizontal",...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,h.cn)("shrink-0 bg-gray-200","horizontal"===a?"h-[1px] w-full":"w-[1px] h-full",t),...n})});g.displayName="Separator";var f=t(47796);function v(e){let r,t,{isOpen:h,onOpenChange:v}=e,[b,j]=(0,a.useState)(null),[N,y]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),[C,S]=(0,a.useState)(null),[E,Z]=(0,a.useState)(null);(0,n.useRouter)();let k=async()=>{try{y(!0),S(null);let e=await fetch("/api/subscription"),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to fetch subscription");j(r)}catch(e){console.error("Error fetching subscription:",e),S(e instanceof Error?e.message:"Failed to fetch subscription")}finally{y(!1)}},F=async()=>{if(b)try{_(!0),S(null),Z(null);let e=await fetch("/api/subscription",{method:"DELETE"}),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to cancel subscription");Z(r.message),await k()}catch(e){console.error("Error canceling subscription:",e),S(e instanceof Error?e.message:"Failed to cancel subscription")}finally{_(!1)}},z=async()=>{if(b)try{_(!0),S(null),Z(null);let e=await fetch("/api/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reactivate"})}),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to reactivate subscription");Z(r.message),await k()}catch(e){console.error("Error reactivating subscription:",e),S(e instanceof Error?e.message:"Failed to reactivate subscription")}finally{_(!1)}};(0,a.useEffect)(()=>{h&&k()},[h]);let R=e=>new Date(1e3*e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,s.jsx)(x.Vq,{open:h,onOpenChange:v,children:(0,s.jsxs)(x.cZ,{className:"bg-white sm:max-w-[500px] max-h-[90vh] overflow-auto",children:[(0,s.jsxs)(x.fK,{children:[(0,s.jsxs)(x.$N,{className:"flex items-center gap-2",children:[(0,s.jsx)(i.Z,{className:"h-5 w-5 text-purple-600"}),"Manage Subscription"]}),(0,s.jsx)(x.Be,{children:"View and manage your premium subscription"})]}),N?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(c.Z,{className:"h-8 w-8 animate-spin text-purple-600"})}):C?(0,s.jsxs)(f.bZ,{variant:"destructive",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)(f.X,{children:C})]}):b?(0,s.jsxs)("div",{className:"space-y-6",children:[E&&(0,s.jsxs)(f.bZ,{className:"border-green-200 bg-green-50",children:[(0,s.jsx)(o.Z,{className:"h-4 w-4 text-green-600"}),(0,s.jsx)(f.X,{className:"text-green-800",children:E})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[b.plan," Plan"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(r=b.amount,t=b.currency,new Intl.NumberFormat("en-US",{style:"currency",currency:t.toUpperCase()}).format(r/100))," / ",b.interval]})]}),((e,r)=>{if(r)return(0,s.jsx)(m.C,{variant:"outline",className:"text-orange-600 border-orange-300",children:"Canceling"});switch(e){case"active":return(0,s.jsx)(m.C,{variant:"default",className:"bg-green-100 text-green-800 border-green-300",children:"Active"});case"canceled":return(0,s.jsx)(m.C,{variant:"destructive",children:"Canceled"});case"past_due":return(0,s.jsx)(m.C,{variant:"outline",className:"text-red-600 border-red-300",children:"Past Due"});default:return(0,s.jsx)(m.C,{variant:"outline",children:e})}})(b.status,b.cancel_at_period_end)]}),(0,s.jsx)(g,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Current period"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[R(b.current_period_start)," - ",R(b.current_period_end)]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Next billing date"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:b.cancel_at_period_end?"Subscription will end on "+R(b.current_period_end):R(b.current_period_end)})]})]})]}),(0,s.jsx)(g,{}),(0,s.jsxs)("div",{className:"space-y-3",children:[b.cancel_at_period_end?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)(f.bZ,{className:"border-orange-200 bg-orange-50",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4 text-orange-600"}),(0,s.jsxs)(f.X,{className:"text-orange-800",children:["Your subscription is scheduled to cancel at the end of the current billing period. You will continue to have access to premium features until ",R(b.current_period_end),"."]})]}),(0,s.jsx)(p.z,{onClick:z,disabled:w,className:"w-full bg-green-600 hover:bg-green-700",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):"Reactivate Subscription"})]}):(0,s.jsx)(p.z,{onClick:F,disabled:w,variant:"outline",className:"w-full text-red-600 border-red-300 hover:bg-red-50",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):"Cancel Subscription"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Canceling will stop your subscription at the end of the current billing period. You won't be charged for the next period."})]})]}):(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No subscription found"})})]})})}function b(){let[e,r]=(0,a.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.z,{onClick:()=>r(!0),variant:"outline",size:"sm",className:"flex items-center gap-1 text-purple-600 border-purple-300 hover:bg-purple-50",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Manage"})]}),(0,s.jsx)(v,{isOpen:e,onOpenChange:r})]})}},47796:function(e,r,t){t.d(r,{X:function(){return o},bZ:function(){return l}});var s=t(67949),a=t(86265),n=t(49e3),i=t(19290);let c=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef((e,r)=>{let{className:t,variant:a,...n}=e;return(0,s.jsx)("div",{ref:r,role:"alert",className:(0,i.cn)(c({variant:a}),t),...n})});l.displayName="Alert",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h5",{ref:r,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})}).displayName="AlertTitle";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...a})});o.displayName="AlertDescription"},83892:function(e,r,t){t.d(r,{C:function(){return c}});var s=t(67949);t(86265);var a=t(49e3),n=t(19290);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...a})}}}]);